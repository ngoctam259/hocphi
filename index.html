<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <title>Tra c·ª©u th√¥ng tin h·ªçc 47 sinh</title>
    <style>
        body {font-family: Arial, sans-serif;padding: 30px;}
        input {width: 250px;padding: 8px;}
        button {padding: 8px 15px;}
        table {width: 100%;border-collapse: collapse;margin-top: 20px;}
        th, td {border: 1px solid #ddd;padding: 10px;text-align: center;}
        th {background-color: #4CAF50;color: white;}
    </style>
</head>

<body>
    <h2>üîç Tra c·ª©u th√¥ng tin h·ªçc sinh üîç</h2>

    <input type="text" id="searchInput" placeholder="Nh·∫≠p th√¥ng tin c·∫ßn t√¨m..." oninput="searchData()">

    <table>
        <thead>
            <tr>
                <th>STT</th>
                <th>M√£ M√¥n</th>
                <th>H·ªç T√™n</th>
                <th>Ng√†y ƒê√≥ng</th>
                <th>S·ªë Ti·ªÅn</th>
                <th>Tr·∫°ng Th√°i</th>
            </tr>
        </thead>
        <tbody id="results"></tbody>
    </table>

    <script>
        let sheetData = [];

        async function fetchData() {
            const sheetUrl = "https://docs.google.com/spreadsheets/d/1sN5kaLSKsdAL50FRUWgS9dRlfW9Gfs7MLxDyqUzGeaU/gviz/tq?tqx=out:csv&sheet=TongHop";
            const proxyUrl = `https://api.allorigins.win/get?url=${encodeURIComponent(sheetUrl)}`;

            try {
                const response = await fetch(proxyUrl);
                const result = await response.json();
                const csv = result.contents;

                const rows = csv.split("\n").slice(1);
                sheetData = rows.map(row => row.split(";"));

                renderTable(sheetData);
            } catch (error) {
                console.error("L·ªói t·∫£i d·ªØ li·ªáu:", error);
            }
        }

        function renderTable(filteredData) {
            const tbody = document.getElementById("results");
            tbody.innerHTML = "";

            filteredData.forEach(row => {
                const tr = document.createElement("tr");
                row.slice(0, 6).forEach(cell => {
                    const td = document.createElement("td");
                    td.textContent = cell.trim();
                    tr.appendChild(td);
                });
                tbody.appendChild(tr);
            });
        }

        function searchData() {
            const keyword = document.getElementById("searchInput").value.toLowerCase();
            if (keyword === "") {
                renderTable(sheetData);
                return;
            }

            const filtered = sheetData.filter(row => row.some(cell => cell.toLowerCase().includes(keyword)));
            renderTable(filtered);
        }

        window.onload = fetchData;
    </script>
</body>

</html>
