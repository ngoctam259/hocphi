<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <title>Tra c·ª©u th√¥ng tin h·ªçc sinh</title>
    <style>
        body {font-family: Arial, sans-serif;padding: 30px;}
        table {width: 100%;border-collapse: collapse;margin-top: 20px;}
        th, td {border: 1px solid #ddd;padding: 8px;text-align: center;}
        th {background-color: #4CAF50;color: white;}
        input {width: 300px;padding: 8px;margin-bottom: 15px;}
        button {padding: 8px 15px;}
    </style>
</head>

<body>
    <h2>üîç Tra c·ª©u th√¥ng tin h·ªçc sinh üîç</h2>

    <input type="text" id="searchInput" placeholder="Nh·∫≠p th√¥ng tin c·∫ßn t√¨m...">
    <button onclick="searchData()">T√¨m</button>

    <table id="resultsTable" style="display: none;">
        <thead>
            <tr>
                <th>STT</th>
                <th>M√£ M√¥n</th>
                <th>H·ªç T√™n</th>
                <th>Ng√†y ƒê√≥ng</th>
                <th>S·ªë Ti·ªÅn</th>
                <th>Tr·∫°ng Th√°i</th>
            </tr>
        </thead>
        <tbody id="results"></tbody>
    </table>

    <script>
        let sheetData = [];

        async function fetchData() {
            const sheetUrl = "https://docs.google.com/spreadsheets/d/1sN5kaLSKsdAL50FRUWgS9dRlfW9Gfs7MLxDyqUzGeaU/gviz/tq?tqx=out:csv&sheet=TongHop";
            const proxyUrl = `https://api.allorigins.win/get?url=${encodeURIComponent(sheetUrl)}`;

            const response = await fetch(proxyUrl);
            const result = await response.json();
            const csv = result.contents;

            const rows = csv.split("\n").slice(1);
            sheetData = rows.map(row => row.split(";"));
        }

        function searchData() {
            const keyword = document.getElementById("searchInput").value.trim().toLowerCase();
            const tbody = document.getElementById("results");
            tbody.innerHTML = "";

            if (keyword === "") {
                document.getElementById("resultsTable").style.display = "none";
                return;
            }

            const filtered = sheetData.filter(row => row.some(cell => cell.toLowerCase().includes(keyword)));

            filtered.forEach(row => {
                const tr = document.createElement("tr");
                row.slice(0, 6).forEach(cell => {
                    const td = document.createElement("td");
                    td.textContent = cell.trim();
                    tr.appendChild(td);
                });
                tbody.appendChild(tr);
            });

            document.getElementById("resultsTable").style.display = filtered.length > 0 ? "table" : "none";
        }

        window.onload = fetchData;
    </script>
</body>

</html>
